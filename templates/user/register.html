{% extends 'base.html' %}
{% load static %}
{% block title %}珞珈线上书店-首页{% endblock title %}
{% block topfiles %}
<script>
    $(function () {
        $('#btnSendEmail').click(function () {
            // 获取邮箱地址
            var email = $('input[name="email"]').val()
            var csrf = $('input[name="csrfmiddlewaretoken"]').val()
            // 发起ajax请求
            var params = {
                'csrfmiddlewaretoken': csrf,
                'email': email,
            }
            $.post('/user/verifyemail/', params, function (data) {
                // 邮箱地址错误 {'res':0}
                // 发送成功 {'res':1}
                if (data.res == 0){
                    $('input[name="email"]').next().html(data.errmsg).show()
                }
                else
                {
                    $('input[name="email"]').next().html('验证邮件已发送').show()
                }
            })
        })
    })
</script>
{% endblock topfiles %}
{% block body %}


    <form action="{% url 'user:result' %}" method="post">
        {% csrf_token %}
        用户名：<input type="text" name="user_name"> <br>
        密码：<input type="password" name="password"> <br>
        确认密码：<input type="password" name="repeat_password"> <br>
        电话：<input type="text" name="phone_number"> <br>
        地址：<input type="text" name="address"> <br>
        电子邮箱：<input type="text" name="email">
<!--        <div class="user_error">输入错误</div>-->
        <br>
        验证码：<input type="text" name="verify_email_code"> <br>
        <input type="button" id="btnSendEmail" value="发送验证邮件">
        <input type="submit" value="注册"> <br>
    </form>
{% endblock body %}